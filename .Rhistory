# Load required libraries ####
pacman::p_load(podcleaner, here, parallel, readr)
# Define globals ####
path_data <- "C:/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-entrepreneurs/analysis/extract-load-transform/data"
progress <- TRUE; verbose <- FALSE
## Define locals ####
directories <- c("1861-1862")
## General directories ####
path_directories <- utils_make_path(path_data, "general-directories")
general_directory_raw <- utils_load_directories_csv(
"general", directories, path_directories, verbose
)
# Define globals ####
path_data <- "C:/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-pod-cleaner/data"
## General directories ####
path_directories <- utils_make_path(path_data, "general-directories")
general_directory_raw <- utils_load_directories_csv(
"general", directories, path_directories, verbose
)
# Define globals ####
# path_data <- "C:/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-pod-cleaner/data"
path_data <- "mnt/c/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-pod-cleaner/data"
progress <- TRUE; verbose <- FALSE
## Define locals ####
directories <- c("1861-1862")
## General directories ####
path_directories <- utils_make_path(path_data, "general-directories")
general_directory_raw <- utils_load_directories_csv(
"general", directories, path_directories, verbose
)
# Define globals ####
# path_data <- "C:/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-pod-cleaner/data"
path_data <- "/mnt/c/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-pod-cleaner/data"
progress <- TRUE; verbose <- FALSE
## Define locals ####
directories <- c("1861-1862")
## General directories ####
path_directories <- utils_make_path(path_data, "general-directories")
general_directory_raw <- utils_load_directories_csv(
"general", directories, path_directories, verbose
)
# Define globals ####
# path_data <- "C:/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-pod-cleaner/data"
path_data <- "/mnt/c/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-clean-pod/data"
progress <- TRUE; verbose <- FALSE
## Define locals ####
directories <- c("1861-1862")
## General directories ####
path_directories <- utils_make_path(path_data, "general-directories")
general_directory_raw <- utils_load_directories_csv(
"general", directories, path_directories, verbose
)
## trades directories ####
path_directories <- utils_make_path(path_data, "trades-directories")
trades_directory_raw <- utils_load_directories_csv(
"trades", directories, path_directories, verbose
)
# Clean ####
general_directory_clean <-
general_clean_directory(general_directory_raw, progress, verbose)
trades_directory_clean <-
trades_clean_directory(trades_directory_raw, progress, verbose)
## locals ####
# trades_directory <- dplyr::slice(trades_directory_clean, 1:999L)
trades_directory <- trades_directory_clean
general_directory <- general_directory_clean
nthread <- detectCores(all.tests = FALSE, logical = TRUE) - 1L
progress <- TRUE; verbose <- FALSE
combined <- combine_match_general_to_trades(
trades_directory, general_directory, progress, verbose,
method = "osa", max_dist = 5L, nthread = nthread
)
combined
View(combined)
path_output <- "/mnt/c/Users/User/Dropbox/pro/Strathclyde/Fintech research assistant/glasgow-clean-pod/output"
file_name <- "post-office-directory-osa"
## rds ####
readr::write_rds(combined, paste0(path_output, "/", file_name, ".rds"))
readr::write_csv(combined, paste0(path_output, "/", file_name, ".csv"))
devtools::load_all(".")
directory <- tibble::tibble(
page = rep("71", 3L),
surname = c("ABOT", "ABRCROMBIE", "BLAI"), forename = c("Wm.", "Alex", "Jn Huh"),
occupation = c(
"Wine and spirit merchant; house", "Baker", "Victualer"
),
addresses = c("1820 Mary hill", "", "280, High stret")
)
directory
regex <- globals_regex_house_to_address
general_move_house_to_address(directory, regex)
directory <- tibble::tibble(
page = rep("71", 3L),
surname = c("ABOT", "ABRCROMBIE", "BLAI"), forename = c("Wm.", "Alex", "Jn Huh"),
occupation = c(
"Wine and spirit merchant; house", "Baker", "Victualer"
),
addresses = c("1820 Mary hill", "", "280, High stret")
)
regex <- globals_regex_house_to_address
devtools::load_all(".")
directory <- tibble::tibble(
page = rep("71", 3L),
surname = c("ABOT", "ABRCROMBIE", "BLAI"), forename = c("Wm.", "Alex", "Jn Huh"),
occupation = c(
"Wine and spirit merchant; house", "Baker", "Victualer"
),
addresses = c("1820 Mary hill", "", "280, High stret")
)
regex <- globals_regex_house_to_address
general_move_house_to_address(directory, regex)
devtools::load_all(".")
directory <- tibble::tibble(
page = rep("71", 3L),
surname = c("ABOT", "ABRCROMBIE", "BLAI"), forename = c("Wm.", "Alex", "Jn Huh"),
occupation = c(
"Wine and spirit merchant; house", "Baker", "Victualer"
),
addresses = c("1820 Mary hill", "", "280, High stret")
)
regex <- globals_regex_house_to_address
general_move_house_to_address(directory, regex)
directory <- tibble::tibble(
page = c("71", "71"),
surname = c("Abbott", "Abercromby"), forename = c("William", "Alexander"),
occupation = c("Wine and spirit merchant", "Baker"),
addresses = c(
"18, 20 London Street; ho. 136 Queen Street.",
"12 Dixon Street; res, 29 Anderston Quay."
)
)
regex <- globals_regex_house_split_trade
directory
general_split_trade_house_addresses(directory, regex, verbose = FALSE)
devtools::load_all(".")
devtools::load_all(".")
directory <- tibble::tibble(
page = c("71", "71"),
surname = c("Abbott", "Abercromby"), forename = c("William", "Alexander"),
occupation = c("Wine and spirit merchant", "Baker"),
addresses = c(
"18, 20 London Street; ho. 136 Queen Street.",
"12 Dixon Street; res, 29 Anderston Quay."
)
)
regex <- globals_regex_house_split_trade
general_split_trade_house_addresses(directory, regex, verbose = FALSE)
stringi::stri_escape_unicode("-")
stringi::stri_escape_unicode("–")
stringi::stri_escape_unicode("-")
tools::showNonASCIIfile(here::here("R", "globals.r"))
stringi::stri_escape_unicode("„")
tools::showNonASCIIfile(here::here("R", "globals.r"))
